{
	"name": "tf_LoadBDV_41_Shared_PartyRoleAdvisor",
	"properties": {
		"activities": [
			{
				"name": "dcn_StartJob_Result",
				"type": "IfCondition",
				"dependsOn": [
					{
						"activity": "mt_audit_startJob_NextDate",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"userProperties": [],
				"typeProperties": {
					"expression": {
						"value": "@contains(activity('mt_audit_startJob_NextDate').output.resultSets[0]['rows'][0].USP_AUDIT_START_JOB_VARIABLE_SET,'SUCCESS')",
						"type": "Expression"
					},
					"ifFalseActivities": [
						{
							"name": "Throw_Error_Start_Job",
							"type": "Fail",
							"dependsOn": [],
							"userProperties": [],
							"typeProperties": {
								"message": "AUDIT_JOB_FAILED",
								"errorCode": {
									"value": "@activity('mt_audit_startJob_NextDate_Pre').output.resultSets[0]['rows'][0].USP_AUDIT_START_JOB_NEXT_DATE",
									"type": "Expression"
								}
							}
						}
					],
					"ifTrueActivities": [
						{
							"name": "SAT_To_BDV_WT_REGISTERED_REPRESENTATIVE",
							"type": "Script",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_IAS_COMMISSION_SHARE_SAT_TO_BDV_WT_REGISTERED_REPRESENTATIVE(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "RDV_IAS_CERTS_HUB_SAT_To_BDV_WT_ADVISOR_IAS_CERTS",
							"type": "Script",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_IAS_CERTS_HUB_SAT_TO_BDV_WT_ADVISOR_IAS_CERTS(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "BDV_WT_LINK_PARTY_RELATIONSHIP_COMMISSION_SHARE_MC",
							"type": "Script",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_IAS_COMMISSION_SHARE_TO_BDV_WT_LINK_PARTY_RELATIONSHIP_COMMISSION_SHARE_MC(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "BDV_WT_REGISTERED_REPRESENTATIVE_IAS_CERTS",
							"type": "Script",
							"dependsOn": [],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_IAS_CERTS_REGISTERED_REPRESENTATIVE_TO_BDV_WT_REGISTERED_REPRESENTATIVE_IAS_CERTS(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "Set Dummy Variable",
							"description": "Step Added to streamline Flow",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "SAT_To_BDV_WT_REGISTERED_REPRESENTATIVE",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "BDV_WT_LINK_PARTY_RELATIONSHIP_COMMISSION_SHARE_MC",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "RDV_IAS_CERTS_HUB_SAT_To_BDV_WT_ADVISOR_IAS_CERTS",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "BDV_WT_REGISTERED_REPRESENTATIVE_IAS_CERTS",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "Dummy",
								"value": {
									"value": "@variables('temp_tf_Audit_ID')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "LoadBDV_RDV_INVESTIA_UNIVERIS_Share_To_BDV_WT",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_INVESTIA_UNIVERIS_SHARE_TO_BDV_WT_LINK_PARTY_RELATIONSHIP_COMMISSION_SHARE(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "LoadBDV_View_Share_To_BDV",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_VIEW_SHARE_TO_BDV_WT_LINK_PARTY_RELATIONSHIP_COMMISSION_SHARE(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "Set Dummy Variable1",
							"description": "Step Added to streamline Flow",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "LoadBDV_RDV_INVESTIA_UNIVERIS_Share_To_BDV_WT",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "LoadBDV_View_Share_To_BDV",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "Dummy",
								"value": {
									"value": "@variables('temp_tf_Audit_ID')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "LoadBDV_BDV_View_Share_To_BDV_Insert",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL3_T",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADSATLINK_DELETE_AUDIT_ID(',variables('INS013'), ',' , variables('SEL3'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_LINK_PARTY_RELATIONSHIP_SHARE'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SAT_LINK_PARTY_RELATIONSHIP_SHARE''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "LoadBDV_BDV_View_share_To_BDV_LINK",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL1",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADSATLINK_INSERT_AUDIT_ID(',variables('INS011'), ',' , variables('SEL1'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_LINK_PARTY_RELATIONSHIP_SHARE'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SAT_LINK_PARTY_RELATIONSHIP_SHARE''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "LoadBDV_BDV_View_Share_To_BDV_SAT_LINK",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL2",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADLINK_AUDIT_ID_RK(',variables('INS012'), ',' , variables('SEL2'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_LINK_PARTY_RELATIONSHIP_SHARE'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.LINK_PARTY_RELATIONSHIP_SHARE''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL1",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable1",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL1",
								"value": {
									"value": "@concat(variables('SEL011'),'''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL2",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable1",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL2",
								"value": {
									"value": "@concat(variables('SEL012'),'''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "Set Dummy Variable2",
							"description": "Step Added to streamline Flow",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "LoadBDV_BDV_View_Share_To_BDV_Insert",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "LoadBDV_BDV_View_share_To_BDV_LINK",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "LoadBDV_BDV_View_Share_To_BDV_SAT_LINK",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "Dummy",
								"value": {
									"value": "@variables('temp_tf_Audit_ID')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "LoadBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_To_BDV_1",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable2",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_TO_BDV_WT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "LoadBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_To_BDV_2",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable2",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SP_CONV_LOADBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_TO_BDV_WT_PARTY_ROLE_ADVISOR_COMPUTE_INVESTIA_UNIVERIS(''',pipeline().globalParameters.ENV,''',',variables('temp_dataStartDate'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "Set Dummy Variable3",
							"description": "Step Added to streamline Flow",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "LoadBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_To_BDV_1",
									"dependencyConditions": [
										"Succeeded"
									]
								},
								{
									"activity": "LoadBDV_RDV_SAT_REGISTERED_REPRESENTATIVE_To_BDV_2",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "Dummy",
								"value": {
									"value": "@variables('temp_tf_Audit_ID')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL4",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable3",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL4",
								"value": {
									"value": "@concat(variables('SEL014'),'''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL5",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable3",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL5",
								"value": {
									"value": "@concat(variables('SEL015'),'''',variables('temp_dataStartDate'),'''',',','''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL6",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable3",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL6",
								"value": {
									"value": "@concat(variables('SEL016'),'''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						},
						{
							"name": "m_Datavault_LoadSatellite_Insert - AUDIT_ID",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL4",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADSATELLITE_INSERT_AUDIT_ID(',variables('INS014'), ',' , variables('SEL4'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SAT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "m_Datavault_LoadSatellite_Delete - AUDIT_ID",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL5",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADSATELLITE_DELETE_AUDIT_ID(',variables('INS015'), ',' , variables('SEL5'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.SAT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "m_Datavault_LoadHub - AUDIT_ID",
							"type": "Script",
							"dependsOn": [
								{
									"activity": "ASSIGN AUDIT_ID TO SEL6",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"policy": {
								"timeout": "7.00:00:00",
								"retry": 0,
								"retryIntervalInSeconds": 30,
								"secureOutput": false,
								"secureInput": false
							},
							"userProperties": [],
							"linkedServiceName": {
								"referenceName": "ls_snowflake_keyvault_auth",
								"type": "LinkedServiceReference",
								"parameters": {
									"DBName": "DB_IAW_DEV_STG"
								}
							},
							"typeProperties": {
								"scripts": [
									{
										"type": "Query",
										"text": {
											"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.SP_CONV_DATAVAULT_LOADHUB_AUDIT_ID(',variables('INS016'), ',' , variables('SEL6'), ',' ,'''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.WT_PARTY_ROLE_ADVISOR_COMPUTE_IAS_WEALTH'',''DB_IAW_',pipeline().globalParameters.ENV,'_DWH.SHARED_BDV.HUB_PARTY_ROLE_ADVISOR''',',',variables('TRUNC_TBL'),')')",
											"type": "Expression"
										}
									}
								]
							}
						},
						{
							"name": "ASSIGN AUDIT_ID TO SEL3_T",
							"type": "SetVariable",
							"dependsOn": [
								{
									"activity": "Set Dummy Variable1",
									"dependencyConditions": [
										"Succeeded"
									]
								}
							],
							"userProperties": [],
							"typeProperties": {
								"variableName": "SEL3",
								"value": {
									"value": "@concat(variables('SEL013'),'''',variables('temp_dataStartDate'),'''',',','''',variables('temp_tf_Audit_ID'),'''''')",
									"type": "Expression"
								}
							}
						}
					]
				}
			},
			{
				"name": "temp_JobName",
				"type": "SetVariable",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"variableName": "temp_JobName",
					"value": {
						"value": "@concat('''',pipeline().Pipeline,'''')",
						"type": "Expression"
					}
				}
			},
			{
				"name": "temp_tf_Audit_ID",
				"type": "SetVariable",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"variableName": "temp_tf_Audit_ID",
					"value": {
						"value": "@concat('''',pipeline().Pipeline,'-',pipeline().RunId,'''')",
						"type": "Expression"
					}
				}
			},
			{
				"name": "temp_JobStartDate",
				"type": "SetVariable",
				"dependsOn": [
					{
						"activity": "mt_audit_startJob_NextDate_Pre",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"userProperties": [],
				"typeProperties": {
					"variableName": "temp_dataStartDate",
					"value": {
						"value": "@concat('''',activity('mt_audit_startJob_NextDate_Pre').output.resultSets[0]['rows'][0].USP_AUDIT_START_JOB_NEXT_DATE,'''')",
						"type": "Expression"
					}
				}
			},
			{
				"name": "mt_audit_startJob_NextDate_Pre",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "temp_tf_Audit_ID",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "temp_JobName",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "ls_snowflake_keyvault_auth",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": {
								"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.USP_AUDIT_START_JOB_NEXT_DATE(',variables('temp_JobName'),',',variables('temp_tf_Audit_ID'),')')",
								"type": "Expression"
							}
						}
					]
				}
			},
			{
				"name": "mt_audit_startJob_NextDate",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "temp_JobStartDate",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "ls_snowflake_keyvault_auth",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": {
								"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.USP_AUDIT_START_JOB_Variable_Set(',variables('temp_JobName'),',',variables('temp_dataStartDate'),')')",
								"type": "Expression"
							}
						}
					]
				}
			},
			{
				"name": "dt_Audit_EndJob",
				"type": "Script",
				"dependsOn": [
					{
						"activity": "dcn_StartJob_Result",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "ls_snowflake_keyvault_auth",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": {
								"value": "@concat('call DB_IAW_',pipeline().globalParameters.ENV,'_DWH.TOOLS.USP_AUDIT_END_JOB(',variables('temp_JobName'),',',variables('temp_dataStartDate'),',',variables('temp_tf_Audit_ID'),',','''SUCCESS''',',','''Successful execution''',')')",
								"type": "Expression"
							}
						}
					]
				}
			}
		],
		"variables": {
			"temp_dataStartDate": {
				"type": "String"
			},
			"temp_JobName": {
				"type": "String"
			},
			"temp_tf_Audit_ID": {
				"type": "String"
			},
			"TRUNC_TBL": {
				"type": "String",
				"defaultValue": "'N'"
			},
			"INS011": {
				"type": "String",
				"defaultValue": "'HK_LINK,MD_START_DT,MD_HASHDIFF,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,COM_TYPE,COMMISSIONPCT,IS_RESHARED,PHYSICAL,TOREPID,COMMISSIONPCT_ADVISOR,COMMISSIONPCT_FINANCIAL,MD_CREATION_DT,MD_ACTIVE,MD_CREATION_AUDIT_ID'"
			},
			"SEL011": {
				"type": "String",
				"defaultValue": "'SRC.HK_LINK,SRC.MD_START_DT,SRC.MD_HASHDIFF,SRC.MD_SOURCE,SRC.MD_SRC_SYSTEM,SRC.MD_EXTRACT_DT,SRC.COM_TYPE,SRC.COMMISSIONPCT,SRC.IS_RESHARED,SRC.PHYSICAL,SRC.TOREPID,SRC.COMMISSIONPCT_ADVISOR,SRC.COMMISSIONPCT_FINANCIAL,CURRENT_TIMESTAMP,''A'',"
			},
			"SEL": {
				"type": "String"
			},
			"INS012": {
				"type": "String",
				"defaultValue": "'HK_LINK,HK_HUB_REGISTERED_REPRESENTATIVE,HK_HUB_PARTY_ROLE_ADVISOR,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,A_C_REPRESENTATIVE,MASTER_CODE,MD_CREATION_DT,MD_CREATION_AUDIT_ID'"
			},
			"SEL012": {
				"type": "String",
				"defaultValue": "'STG.HK_LINK,STG.HK_HUB_REGISTERED_REPRESENTATIVE,STG.HK_HUB_ADVISOR,STG.MD_SOURCE,STG.MD_SRC_SYSTEM,STG.MD_EXTRACT_DT,STG.A_C_REPRESENTATIVE,STG.MASTER_CODE,CURRENT_TIMESTAMP,"
			},
			"INS013": {
				"type": "String",
				"defaultValue": "'HK_LINK,MD_HASHDIFF,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,COM_TYPE,COMMISSIONPCT,IS_RESHARED,PHYSICAL,TOREPID,COMMISSIONPCT_ADVISOR,COMMISSIONPCT_FINANCIAL,MD_CREATION_DT,MD_ACTIVE,MD_START_DT,MD_CREATION_AUDIT_ID'"
			},
			"SEL013": {
				"type": "String",
				"defaultValue": "'SAT.HK_LINK,SAT.MD_HASHDIFF,SAT.MD_SOURCE,SAT.MD_SRC_SYSTEM,SAT.MD_EXTRACT_DT,SAT.COM_TYPE,SAT.COMMISSIONPCT,SAT.IS_RESHARED,SAT.PHYSICAL,SAT.TOREPID,SAT.COMMISSIONPCT_ADVISOR,SAT.COMMISSIONPCT_FINANCIAL,CURRENT_TIMESTAMP,''D'',"
			},
			"INS014": {
				"type": "String",
				"defaultValue": "'HK_HUB,MD_START_DT,MD_HASHDIFF,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,COMPANY_CODE,COMPANY_NAME,REGULATORY_ORGANIZATION_NAME,REGULATORY_ORGANIZATION_CODE,DEALER_CODE,DEALER_NAME,REGION_CODE,REGION_NAME,REGION_VP,BRANCHCODE,BRANCHNAME,TEAM_CODE,TEAM_NAME,ADVISOR_FULLNAME,FIRSTNAME,LASTNAME,ADVISOR_CORPORATION_NAME,STATUS,GROUP_RSP_INDICATOR,PROVINCE_CODE,PROVINCE,ADVISOR_START_DATE,NEW_ADVISOR,DEPARTED_ADVISOR_IND,PRIMARY_ROLE,END_DATE,REASON,NEW_FIRM,NEW_FIRM_TYPE,NEW_FIRM_BACK_OFFICE,PRESTIGE_STATUS,TRANSITION_PERIOD_END_DATE,DEAL_ASSESTS,EXPECTED_ASSESTS,PREVIOUS_FIRM,PREVIOUS_FIRM_TYPE,AGE_SEGMENT,AGE_SEGMENT_ORD,MD_ACTIVE_CERTS,ADVISOR_AGE,REP_EMAIL,CBM,BRANCH_ADDRESS1,BRANCH_ADDRESS2,BRANCH_CITY,BRANCH_POSTAL_CODE,BRANCH_NRD,ADVISOR_NAME,MD_CREATION_DT,MD_ACTIVE,MD_CREATION_AUDIT_ID'"
			},
			"SEL014": {
				"type": "String",
				"defaultValue": "'STG.HK_HUB,STG.MD_START_DT,STG.MD_HASHDIFF,STG.MD_SOURCE,STG.MD_SRC_SYSTEM,STG.MD_EXTRACT_DT,STG.COMPANY_CODE,STG.COMPANY_NAME,STG.REGULATORY_ORGANIZATION_NAME,STG.REGULATORY_ORGANIZATION_CODE,STG.DEALER_CODE,STG.DEALER_NAME,STG.REGION_CODE,STG.REGION_NAME,STG.REGION_VP,STG.BRANCHCODE,STG.BRANCHNAME,STG.TEAM_CODE,STG.TEAM_NAME,STG.ADVISOR_FULLNAME,STG.FIRSTNAME,STG.LASTNAME,STG.ADVISOR_CORPORATION_NAME,STG.STATUS,STG.GROUP_RSP_INDICATOR,STG.PROVINCE_CODE,STG.PROVINCE,STG.ADVISOR_START_DATE,STG.NEW_ADVISOR,STG.DEPARTED_ADVISOR_IND,STG.PRIMARY_ROLE,STG.END_DATE,STG.REASON,STG.NEW_FIRM,STG.NEW_FIRM_TYPE,STG.NEW_FIRM_BACK_OFFICE,STG.PRESTIGE_STATUS,STG.TRANSITION_PERIOD_END_DATE,STG.DEAL_ASSESTS,STG.EXPECTED_ASSESTS,STG.PREVIOUS_FIRM,STG.PREVIOUS_FIRM_TYPE,STG.AGE_SEGMENT,STG.AGE_SEGMENT_ORD,STG.MD_ACTIVE_CERTS,STG.ADVISOR_AGE,STG.REP_EMAIL,STG.CBM,STG.BRANCH_ADDRESS1,STG.BRANCH_ADDRESS2,STG.BRANCH_CITY,STG.BRANCH_POSTAL_CODE,STG.BRANCH_NRD,STG.ADVISOR_NAME,CURRENT_TIMESTAMP,''A'',"
			},
			"INS015": {
				"type": "String",
				"defaultValue": "'HK_HUB,MD_HASHDIFF,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,COMPANY_CODE,COMPANY_NAME,REGULATORY_ORGANIZATION_NAME,REGULATORY_ORGANIZATION_CODE,DEALER_CODE,DEALER_NAME,REGION_CODE,REGION_NAME,REGION_VP,BRANCHCODE,BRANCHNAME,TEAM_CODE,TEAM_NAME,ADVISOR_FULLNAME,FIRSTNAME,LASTNAME,ADVISOR_CORPORATION_NAME,STATUS,GROUP_RSP_INDICATOR,PROVINCE_CODE,PROVINCE,ADVISOR_START_DATE,NEW_ADVISOR,DEPARTED_ADVISOR_IND,PRIMARY_ROLE,END_DATE,REASON,NEW_FIRM,NEW_FIRM_TYPE,NEW_FIRM_BACK_OFFICE,PRESTIGE_STATUS,TRANSITION_PERIOD_END_DATE,DEAL_ASSESTS,EXPECTED_ASSESTS,PREVIOUS_FIRM,PREVIOUS_FIRM_TYPE,AGE_SEGMENT,AGE_SEGMENT_ORD,MD_ACTIVE_CERTS,ADVISOR_AGE,REP_EMAIL,CBM,BRANCH_ADDRESS1,BRANCH_ADDRESS2,BRANCH_CITY,BRANCH_POSTAL_CODE,BRANCH_NRD,MD_CREATION_DT,MD_ACTIVE,MD_START_DT,MD_CREATION_AUDIT_ID'"
			},
			"SEL015": {
				"type": "String",
				"defaultValue": "'SAT.HK_HUB,SAT.MD_HASHDIFF,SAT.MD_SOURCE,SAT.MD_SRC_SYSTEM,SAT.MD_EXTRACT_DT,SAT.COMPANY_CODE,SAT.COMPANY_NAME,SAT.REGULATORY_ORGANIZATION_NAME,SAT.REGULATORY_ORGANIZATION_CODE,SAT.DEALER_CODE,SAT.DEALER_NAME,SAT.REGION_CODE,SAT.REGION_NAME,SAT.REGION_VP,SAT.BRANCHCODE,SAT.BRANCHNAME,SAT.TEAM_CODE,SAT.TEAM_NAME,SAT.ADVISOR_FULLNAME,SAT.FIRSTNAME,SAT.LASTNAME,SAT.ADVISOR_CORPORATION_NAME,SAT.STATUS,SAT.GROUP_RSP_INDICATOR,SAT.PROVINCE_CODE,SAT.PROVINCE,SAT.ADVISOR_START_DATE,SAT.NEW_ADVISOR,SAT.DEPARTED_ADVISOR_IND,SAT.PRIMARY_ROLE,SAT.END_DATE,SAT.REASON,SAT.NEW_FIRM,SAT.NEW_FIRM_TYPE,SAT.NEW_FIRM_BACK_OFFICE,SAT.PRESTIGE_STATUS,SAT.TRANSITION_PERIOD_END_DATE,SAT.DEAL_ASSESTS,SAT.EXPECTED_ASSESTS,SAT.PREVIOUS_FIRM,SAT.PREVIOUS_FIRM_TYPE,SAT.AGE_SEGMENT,SAT.AGE_SEGMENT_ORD,SAT.MD_ACTIVE_CERTS,SAT.ADVISOR_AGE,SAT.REP_EMAIL,SAT.CBM,SAT.BRANCH_ADDRESS1,SAT.BRANCH_ADDRESS2,SAT.BRANCH_CITY,SAT.BRANCH_POSTAL_CODE,SAT.BRANCH_NRD,CURRENT_TIMESTAMP,''D'',"
			},
			"SEL1": {
				"type": "String"
			},
			"SEL2": {
				"type": "String"
			},
			"SEL3": {
				"type": "String"
			},
			"SEL4": {
				"type": "String"
			},
			"Dummy": {
				"type": "String"
			},
			"SEL5": {
				"type": "String"
			},
			"INS016": {
				"type": "String",
				"defaultValue": "'HK_HUB,MD_SOURCE,MD_SRC_SYSTEM,MD_EXTRACT_DT,MASTER_CODE,MD_CREATION_DT,MD_CREATION_AUDIT_ID'"
			},
			"SEL016": {
				"type": "String",
				"defaultValue": "'STG.HK_HUB,STG.MD_SOURCE,STG.MD_SRC_SYSTEM,STG.MD_EXTRACT_DT,STG.MASTER_CODE,CURRENT_TIMESTAMP,"
			},
			"SEL6": {
				"type": "String"
			}
		},
		"folder": {
			"name": "IAW/41_BDV_IAWEALTH/SHARED_ADVISORS"
		},
		"annotations": [],
		"lastPublishTime": "2022-11-10T15:19:54Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}